<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Juego de Memoria Stitch</title>
  <link rel="shortcut icon" href="jquery.ico" type="image/x-icon" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      overflow-x: hidden;
      background: linear-gradient(to bottom right, #e0f7fa, #c8e6c9);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding: 2rem;
      font-family: 'Arial', sans-serif;
    }

    .header {
      text-align: center;
      margin-bottom: 1rem;
    }

    .header h1 {
      color: #2e7d32;
      margin-bottom: 0.5rem;
    }

    .header h2 {
      color: #388e3c;
      font-size: 1.2rem;
      font-weight: normal;
    }

    nav.nav {
      width: 100%;
      margin-bottom: 1rem;
      display: flex;
      justify-content: flex-start;
    }

    nav.nav a {
      color: #2e7d32;
      text-decoration: none;
      font-size: 1.5rem;
      transition: transform 0.3s;
    }

    nav.nav a:hover {
      transform: translateX(-5px);
    }

    .game-info {
      display: flex;
      justify-content: space-between;
      width: 90%;
      max-width: 600px;
      margin-bottom: 1rem;
    }

    #temporizador,
    #puntaje {
      font-size: 1.2rem;
      color: #2e7d32;
      background: rgba(255, 255, 255, 0.7);
      padding: 0.5rem 1rem;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .tablero {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1rem;
      width: 90%;
      max-width: 600px;
      margin-bottom: 1.5rem;
      border: 4px solid #2e7d32;
      border-radius: 15px;
      padding: 1rem;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
      background-image: url('imagenes/fondo.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-color: rgba(255, 255, 255, 0.85);
      background-blend-mode: multiply;
    }

    .carta {
      position: relative;
      width: 100%;
      padding-top: 100%;
      perspective: 1000px;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .carta:hover {
      transform: scale(1.05);
    }

    .carta-inner {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      width: 100%;
      height: 100%;
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }

    .carta.volteada .carta-inner {
      transform: rotateY(180deg);
    }

    .carta-frente,
    .carta-dorso {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .carta-frente {
      background-color: #ffffff;
      display: flex;
      align-items: center;
      justify-content: center;
      transform: rotateY(180deg);
    }

    .carta-frente img {
      width: 80%;
      height: 80%;
      object-fit: contain;
    }

    .carta-dorso {
      background: repeating-linear-gradient(45deg, #81c784, #81c784 10px, #66bb6a 10px, #66bb6a 20px);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      color: #fff;
      font-weight: bold;
      text-shadow: 1px 1px 2px #388e3c;
      border: 2px solid #2e7d32;
    }

    #btnReiniciar {
      padding: 0.8rem 1.5rem;
      background-color: #43a047;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease-in-out;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    #btnReiniciar:hover {
      background-color: #388e3c;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    @media (max-width: 600px) {
      .tablero {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    @media (max-width: 400px) {
      .tablero {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
</head>

<body>
  <nav class="nav">
    <a href="index.html" title="Volver al inicio">
      <i class="fas fa-arrow-left"></i>
    </a>
  </nav>

  <main>
    <header class="header">
      <h1>Juego de Memoria Stitch</h1>
      <h2>Encuentra todos los pares antes de que se acabe el tiempo</h2>
    </header>

    <div class="game-info">
      <div id="temporizador">
        <i class="fas fa-clock"></i> Tiempo: <span id="tiempo">60</span>s
      </div>
      <div id="puntaje">
        <i class="fas fa-star"></i> Aciertos: <span id="aciertos">0</span>/6
      </div>
    </div>

    <div class="tablero" id="tablero"></div>

    <button id="btnReiniciar">
      <i class="fas fa-redo"></i> Jugar de nuevo
    </button>
  </main>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function () {
      const imagenesOriginales = [
        "stitch1.png", "stitch2.png", "stitch3.png",
        "stitch4.png", "stitch5.png", "stitch6.png"
      ];

      const $tablero = $('#tablero');
      const $btnReiniciar = $('#btnReiniciar');
      const $tiempoDisplay = $('#tiempo');
      const $aciertosDisplay = $('#aciertos');

      let primera = null;
      let segunda = null;
      let bloqueado = false;
      let aciertos = 0;
      let tiempoRestante = 60;
      let temporizadorId = null;

      function iniciarTemporizador() {
        tiempoRestante = 60;
        $tiempoDisplay.text(tiempoRestante);

        if (temporizadorId) clearInterval(temporizadorId);

        temporizadorId = setInterval(() => {
          tiempoRestante--;
          $tiempoDisplay.text(tiempoRestante);

          if (tiempoRestante <= 10) {
            $tiempoDisplay.css('color', '#e53935');
          }

          if (tiempoRestante <= 0) {
            clearInterval(temporizadorId);
            bloquearJuegoPorTiempo();
          }
        }, 1000);
      }

      function bloquearJuegoPorTiempo() {
        bloqueado = true;
        $btnReiniciar.html('<i class="fas fa-hourglass-end"></i> Tiempo agotado! Jugar otra vez');
        $('body').css('background', 'linear-gradient(to bottom right, #ffcdd2, #ef9a9a)');
      }

      function reiniciarEstilos() {
        $tiempoDisplay.css('color', '#2e7d32');
        $('body').css('background', 'linear-gradient(to bottom right, #e0f7fa, #c8e6c9)');
      }

      function actualizarPuntaje() {
        $aciertosDisplay.text(aciertos);
      }

      function crearCartas() {
        $tablero.empty();
        let pares = [...imagenesOriginales, ...imagenesOriginales];

        // Mezclar las cartas usando el algoritmo Fisher-Yates
        for (let i = pares.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [pares[i], pares[j]] = [pares[j], pares[i]];
        }

        pares.forEach(img => {
          const carta = $('<div>').addClass('carta');
          const inner = $('<div>').addClass('carta-inner');
          const frente = $('<div>').addClass('carta-frente');
          const imagen = $('<img>').attr('src', `imagenes/${img}`);
          const dorso = $('<div>').addClass('carta-dorso');

          frente.append(imagen);
          inner.append(dorso, frente);
          carta.append(inner);
          $tablero.append(carta);

          carta.on('click', function () {
            if (bloqueado || $(this).hasClass('volteada')) return;

            $(this).addClass('volteada');

            if (!primera) {
              primera = $(this);
            } else {
              segunda = $(this);
              bloqueado = true;

              const img1 = primera.find('img').attr('src');
              const img2 = segunda.find('img').attr('src');

              if (img1 === img2) {
                aciertos++;
                actualizarPuntaje();

                // Marcar las cartas como acertadas
                primera.addClass('acertada');
                segunda.addClass('acertada');

                primera = null;
                segunda = null;
                bloqueado = false;

                if (aciertos === imagenesOriginales.length) {
                  clearInterval(temporizadorId);
                  $btnReiniciar.html('<i class="fas fa-trophy"></i> ¡Ganaste! Jugar otra vez');
                  $('body').css('background', 'linear-gradient(to bottom right, #c8e6c9, #a5d6a7)');
                }
              } else {
                setTimeout(() => {
                  primera.removeClass('volteada');
                  segunda.removeClass('volteada');
                  primera = null;
                  segunda = null;
                  bloqueado = false;
                }, 1000);
              }
            }
          });
        });
      }

      function iniciarJuego() {
        primera = null;
        segunda = null;
        bloqueado = false;
        aciertos = 0;
        actualizarPuntaje();
        reiniciarEstilos();

        iniciarTemporizador();
        crearCartas();

        $btnReiniciar.html('<i class="fas fa-redo"></i> Jugar de nuevo');
      }

      $btnReiniciar.on('click', iniciarJuego);

      // Iniciar el juego al cargar la página
      iniciarJuego();
    });
  </script>
</body>

</html>